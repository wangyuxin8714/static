<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <select id="province">
        <option>-请选择-</option>
    </select>
    <select id="city">
        <option>-请选择-</option>
    </select>
    <select id="area">
        <option>-请选择-</option>
    </select>
</body>
<script>
    var province = document.getElementById("province");//省
    var city = document.getElementById("city");//市
    var area = document.getElementById("area");//区
    var provinceSel = null;//用来存储当前选中的省份对应的数据
    init();

    function init(){
        ajax({
            url:"data.json",
            success:function(data){
               /* data.forEach(function(item){
                    //创建省份
                    var option = document.createElement("option");
                    option.innerHTML = item.name;
                    province.appendChild(option);
                })*/
                drawSelect(data,province);
                bindEvent(data);
            }
        })
    }
    /**
     * 为下拉框绑定事件
     * */
    function bindEvent(data){
        province.onchange = function(){
            var cities = null;
            for(var i in data){
                if(this.value==data[i].name){
                    cities=data[i].city;
                    provinceSel = data[i];//把当前选中的省份对应的数据保存一份
                    break;
                }
            }
            drawSelect(cities,city);//更新城市对应的下拉框
        }
        city.onchange = function(){
               for(var i=0;i<data.length;i++){
                   if(data[i].name==province.value){
                       var cityes = data[i].city;
                       for(var j=0;j<cityes.length;j++){
                           if(cityes[j].name==this.value){
                                var areas = cityes[j].area;//对应的区域
                               drawSelect(areas,area);
                               break;
                           }
                       }
                       break;
                   }
               }
        }

    }
    //data 要显示的数据  sel 要更新的下拉框
    function drawSelect(data,sel){
        sel.innerHTML="<option>-请选择-</option>";//每次更新先清空
        data.forEach(function(item){
            var option = document.createElement("option");
            if(sel==area){
                option.innerHTML = item;
            }else{
                option.innerHTML = item.name;
            }
            sel.appendChild(option);
        })
    }
    /**
     * {url:"",success:function(){}}
     * @param obj
     */
    function ajax(obj){
        var xhr = null;
        if(window.XMLHttpRequest){
            xhr = new XMLHttpRequest();
        }else{
            xhr = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xhr.open("get",obj.url,true);
        xhr.send(null);
        xhr.onreadystatechange = function(){
            if(xhr.readyState==4){
                if(xhr.status==200){
                    obj.success(JSON.parse(xhr.responseText));
                }else{
                    obj.error();
                }
            }
        }
    }
</script>
</html>